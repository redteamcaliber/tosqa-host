(function() {
  var circuitsCtrl, ng,
    __slice = [].slice;

  ng = angular.module('myApp');

  ng.config(function($stateProvider, navbarProvider) {
    $stateProvider.state('circuits', {
      url: '/circuits',
      templateUrl: '/circuits/circuits.html',
      controller: circuitsCtrl
    });
    return navbarProvider.add('/circuits', 'Circuits', 30);
  });

  circuitsCtrl = function($scope, jeebus) {
    var handlers, setup, updatePinList;
    $scope.circuits = {};
    $scope.gadgets = {
      Pipe: {
        name: 'Pipeline',
        shade: '#d8d8d8',
        icon: '\uf061',
        inputs: 'In',
        outputs: 'Out'
      },
      Printer: {
        shade: '#dacfc0',
        icon: '\uf02f',
        inputs: 'In In2'
      },
      clock: {
        shade: '#dacfc0',
        icon: '\uf017',
        inputs: 'Rate',
        outputs: 'Pulse'
      },
      tosqa_logo: {
        shade: '#fbea5b',
        icon: 'TQ',
        inputs: 'Rate',
        outputs: 'X Y'
      },
      StepGen: {
        shade: '#d2e38f',
        icon: '\uf013',
        inputs: 'Params',
        outputs: 'Out'
      },
      SSB: {
        shade: '#fbea5b',
        icon: '\uf0b2',
        inputs: 'Cmds'
      }
    };
    $scope.circuit = {
      gadgets: {},
      wires: {},
      feeds: {}
    };
    updatePinList = function() {
      var g, gid, ins, p, _i, _len, _ref, _ref1;
      $scope.inputPins = [];
      _ref = $scope.circuit.gadgets;
      for (gid in _ref) {
        g = _ref[gid];
        if (ins = $scope.gadgets[g.type].inputs) {
          _ref1 = ins.split(' ');
          for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
            p = _ref1[_i];
            $scope.inputPins.push("" + gid + "." + p);
          }
        }
      }
      return $scope.inputPins.sort();
    };
    $scope.redraw = function() {
      console.log('redraw');
      $scope.circuit = {
        gadgets: {},
        wires: {},
        feeds: {}
      };
      return jeebus.attach('circuit/demo1').on('data', function() {
        var args, obj, temp, _i, _j, _len, _len1, _results;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        temp = this.rows;
        for (_i = 0, _len = temp.length; _i < _len; _i++) {
          obj = temp[_i];
          $scope.circuit.gadgets[obj.id] = obj;
        }
        _results = [];
        for (_j = 0, _len1 = temp.length; _j < _len1; _j++) {
          obj = temp[_j];
          angular.forEach(obj.feed, function(v, k) {
            return $scope.circuit.feeds["" + obj.id + "." + k] = v;
          });
          _results.push(angular.forEach(obj.wire, function(v, k) {
            var to;
            to = (v.split("."))[0];
            if ($scope.circuit.gadgets[to] != null) {
              return $scope.circuit.wires["" + obj.id + "." + k + "/" + v] = 0;
            }
          }));
        }
        return _results;
      });
    };
    $scope.$watch('addPin', function(pin) {
      var _base;
      if (pin) {
        if ((_base = $scope.circuit.feeds)[pin] == null) {
          _base[pin] = [];
        }
        console.log('addFeed', pin, $scope.circuit.feeds[pin].length);
        $scope.circuit.feeds[pin].push('');
        return $scope.addPin = null;
      }
    });
    $scope.delFeed = function(pin, index) {
      var items;
      items = $scope.circuit.feeds[pin];
      console.log('delFeed', pin, index, items[index]);
      items.splice(index, 1);
      if (items.length === 0) {
        return delete $scope.circuit.feeds[pin];
      }
    };
    $scope.$watch('currSel.id', function(x) {
      console.log('fix id', x);
      return updatePinList();
    });
    $scope.$watch('currSel.title', function(x) {
      var id, obj;
      if ($scope.currSel && (x != null)) {
        id = $scope.currSel.id;
        obj = $scope.circuit.gadgets[id];
        obj.title = x;
        jeebus.put("/circuit/demo1/" + id, obj);
        return console.log('fix title', x);
      }
    });
    handlers = {
      addGadget: function(x, y) {
        var id, obj, type;
        if ($scope.newtype != null) {
          id = "g" + String(Date.now() % 1234567);
          type = $scope.newtype;
          obj = {
            title: "" + type,
            type: $scope.newtype,
            x: x,
            y: y
          };
          jeebus.put("/circuit/demo1/" + id, obj);
          return $scope.redraw();
        }
      },
      delGadget: function(id) {
        jeebus.put("/circuit/demo1/" + id);
        return $scope.redraw();
      },
      addWire: function(from, to) {
        var id, obj, output;
        id = (from.split('.'))[0];
        output = (from.split('.'))[1];
        obj = $scope.circuit.gadgets[id];
        obj.wire = obj.wire || {};
        obj.wire[output] = to;
        jeebus.put("/circuit/demo1/" + id, obj);
        return $scope.redraw();
      },
      delWire: function(from, to) {
        var id, obj, pin;
        id = (from.split('.'))[0];
        pin = (from.split('.'))[1];
        obj = $scope.circuit.gadgets[id];
        delete obj.wire[pin];
        jeebus.put("/circuit/demo1/" + id, obj);
        return $scope.redraw();
      },
      selWire: function(from, to) {
        $scope.currSel = {};
        $scope.currSel.id = "" + from + "/" + to;
        $scope.currSel.title = null;
        return $scope.currSel.type = "wire";
      },
      selectGadget: function(id) {
        $scope.currSel = {};
        $scope.currSel.id = id;
        $scope.currSel.title = $scope.circuit.gadgets[id].title;
        return $scope.currSel.type = $scope.circuit.gadgets[id].type;
      },
      moveGadget: function(id, x, y) {
        var obj;
        obj = $scope.circuit.gadgets[id];
        obj.x = x;
        obj.y = y;
        jeebus.put("/circuit/demo1/" + id, obj);
        return $scope.redraw();
      }
    };
    $scope.$on('circuit', function() {
      var args, event, type;
      event = arguments[0], type = arguments[1], args = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
      console.log.apply(console, ['C:', type].concat(__slice.call(args)));
      return handlers[type].apply(handlers, args);
    });
    setup = function() {
      jeebus.attach('circuit/demo1').on('sync', function() {
        var args, obj, temp, _i, _len;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        temp = this.rows;
        for (_i = 0, _len = temp.length; _i < _len; _i++) {
          obj = temp[_i];
          $scope.circuits[obj.id] = obj;
        }
        return console.log("init circuits");
      });
      return $scope.redraw();
    };
    if ($scope.serverStatus === 'connected') {
      setup();
    }
    return $scope.$on('ws-open', setup);
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY3VpdHMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxnQkFBQTtJQUFBLGtCQUFBOztBQUFBLEVBQUEsRUFBQSxHQUFLLE9BQU8sQ0FBQyxNQUFSLENBQWUsT0FBZixDQUFMLENBQUE7O0FBQUEsRUFFQSxFQUFFLENBQUMsTUFBSCxDQUFVLFNBQUMsY0FBRCxFQUFpQixjQUFqQixHQUFBO0FBQ1IsSUFBQSxjQUFjLENBQUMsS0FBZixDQUFxQixVQUFyQixFQUNFO0FBQUEsTUFBQSxHQUFBLEVBQUssV0FBTDtBQUFBLE1BQ0EsV0FBQSxFQUFhLHlCQURiO0FBQUEsTUFFQSxVQUFBLEVBQVksWUFGWjtLQURGLENBQUEsQ0FBQTtXQUlBLGNBQWMsQ0FBQyxHQUFmLENBQW1CLFdBQW5CLEVBQWdDLFVBQWhDLEVBQTRDLEVBQTVDLEVBTFE7RUFBQSxDQUFWLENBRkEsQ0FBQTs7QUFBQSxFQVNBLFlBQUEsR0FBZSxTQUFDLE1BQUQsRUFBUyxNQUFULEdBQUE7QUFFYixRQUFBLDhCQUFBO0FBQUEsSUFBQSxNQUFNLENBQUMsUUFBUCxHQUFpQixFQUFqQixDQUFBO0FBQUEsSUFTQSxNQUFNLENBQUMsT0FBUCxHQUNFO0FBQUEsTUFBQSxJQUFBLEVBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxVQUFOO0FBQUEsUUFDQSxLQUFBLEVBQU8sU0FEUDtBQUFBLFFBRUEsSUFBQSxFQUFNLFFBRk47QUFBQSxRQUdBLE1BQUEsRUFBUSxJQUhSO0FBQUEsUUFJQSxPQUFBLEVBQVMsS0FKVDtPQURGO0FBQUEsTUFNQSxPQUFBLEVBQ0U7QUFBQSxRQUFBLEtBQUEsRUFBTyxTQUFQO0FBQUEsUUFDQSxJQUFBLEVBQU0sUUFETjtBQUFBLFFBRUEsTUFBQSxFQUFRLFFBRlI7T0FQRjtBQUFBLE1BVUEsS0FBQSxFQUNFO0FBQUEsUUFBQSxLQUFBLEVBQU8sU0FBUDtBQUFBLFFBQ0EsSUFBQSxFQUFN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REFDVixDQUFBO0FBQUEsUUFBQSxJQUFBLEdBQU8sSUFBQyxDQUFBLElBQVIsQ0FBQTtBQUNBLGFBQUEsMkNBQUE7eUJBQUE7QUFDRSxVQUFBLE1BQU0sQ0FBQyxRQUFTLENBQUEsR0FBRyxDQUFDLEVBQUosQ0FBaEIsR0FBMEIsR0FBMUIsQ0FERjtBQUFBLFNBREE7ZUFHQSxPQUFPLENBQUMsR0FBUixDQUFZLGVBQVosRUFKUztNQUFBLENBRGIsQ0FBQSxDQUFBO2FBUUMsTUFBTSxDQUFDLE1BQVAsQ0FBQSxFQVRLO0lBQUEsQ0EzSlIsQ0FBQTtBQStLQSxJQUFBLElBQVksTUFBTSxDQUFDLFlBQVAsS0FBdUIsV0FBbkM7QUFBQSxNQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUE7S0EvS0E7V0FnTEEsTUFBTSxDQUFDLEdBQVAsQ0FBVyxTQUFYLEVBQXNCLEtBQXRCLEVBbExhO0VBQUEsQ0FUZixDQUFBO0FBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJuZyA9IGFuZ3VsYXIubW9kdWxlICdteUFwcCdcblxubmcuY29uZmlnICgkc3RhdGVQcm92aWRlciwgbmF2YmFyUHJvdmlkZXIpIC0+XG4gICRzdGF0ZVByb3ZpZGVyLnN0YXRlICdjaXJjdWl0cycsXG4gICAgdXJsOiAnL2NpcmN1aXRzJ1xuICAgIHRlbXBsYXRlVXJsOiAnL2NpcmN1aXRzL2NpcmN1aXRzLmh0bWwnXG4gICAgY29udHJvbGxlcjogY2lyY3VpdHNDdHJsXG4gIG5hdmJhclByb3ZpZGVyLmFkZCAnL2NpcmN1aXRzJywgJ0NpcmN1aXRzJywgMzBcblxuY2lyY3VpdHNDdHJsID0gKCRzY29wZSwgamVlYnVzKSAtPlxuICBcbiAgJHNjb3BlLmNpcmN1aXRzID17fVxuICBcbiAgIyAnI2ZiZWE1YidcbiAgIyAjZGFjZmMwXG4gICMgI2Q4ZDhkOFxuICAjICNkMmUzOGZcbiAgIyAjNzU3Nzc5XG4gIFxuICBcbiAgJHNjb3BlLmdhZGdldHMgPVxuICAgIFBpcGU6XG4gICAgICBuYW1lOiAnUGlwZWxpbmUnXG4gICAgICBzaGFkZTogJyNkOGQ4ZDgnXG4gICAgICBpY29uOiAnXFx1ZjA2MScgIyBmYS1hcnJvdy1yaWdodFxuICAgICAgaW5wdXRzOiAnSW4nXG4gICAgICBvdXRwdXRzOiAnT3V0J1xuICAgIFByaW50ZXI6XG4gICAgICBzaGFkZTogJyNkYWNmYzAnXG4gICAgICBpY29uOiAnXFx1ZjAyZicgIyBmYS1wcmludFxuICAgICAgaW5wdXRzOiAnSW4gSW4yJ1xuICAgIGNsb2NrOlxuICAgICAgc2hhZGU6ICcjZGFjZmMwJ1xuICAgICAgaWNvbjogJ1xcdWYwMTcnICMgZmEtY2xvY2stb1xuICAgICAgaW5wdXRzOiAnUmF0ZSdcbiAgICAgIG91dHB1dHM6ICdQdWxzZSdcbiAgICB0b3NxYV9sb2dvOlxuICAgICAgc2hhZGU6ICcjZmJlYTViJ1xuICAgICAgaWNvbjogJ1RRJyAjIGZhLWNsb2NrLW9cbiAgICAgIGlucHV0czogJ1JhdGUnXG4gICAgICBvdXRwdXRzOiAnWCBZJ1xuICAgIFN0ZXBHZW46XG4gICAgICBzaGFkZTogJyNkMmUzOGYnXG4gICAgICBpY29uOiAnXFx1ZjAxMycgIyBmYS1jb2dcbiAgICAgIGlucHV0czogJ1BhcmFtcydcbiAgICAgIG91dHB1dHM6ICdPdXQnXG4gICAgU1NCOlxuICAgICAgc2hhZGU6ICcjZmJlYTViJ1xuICAgICAgaWNvbjogJ1xcdWYwYjInICMgZmEtYXJyb3dzLWFsdFxuICAgICAgaW5wdXRzOiAnQ21kcydcbiAgICAgIFxuICAkc2NvcGUuY2lyY3VpdCA9XG4gICAgZ2FkZ2V0czp7fVxuICAgIHdpcmVzOnt9XG4gICAgZmVlZHM6e31cbiAgICAgIFxuICB1cGRhdGVQaW5MaXN0ID0gKCkgLT5cbiAgICAkc2NvcGUuaW5wdXRQaW5zID0gW11cbiAgICBmb3IgZ2lkLCBnIG9mICRzY29wZS5jaXJjdWl0LmdhZGdldHNcbiAgICAgIGlmIGlucyA9ICRzY29wZS5nYWRnZXRzW2cudHlwZV0uaW5wdXRzXG4gICAgICAgIGZvciBwIGluIGlucy5zcGxpdCAnICdcbiAgICAgICAgICAkc2NvcGUuaW5wdXRQaW5zLnB1c2ggXCIje2dpZH0uI3twfVwiXG4gICAgJHNjb3BlLmlucHV0UGlucy5zb3J0KClcbiAgXG4gICNmdW5jdGlvbiB0byByZWRyYXcgZWRpdG9yXG4gICRzY29wZS5yZWRyYXcgPSgpIC0+XG4gICAgY29uc29sZS5sb2cgJ3JlZHJhdydcbiAgICAkc2NvcGUuY2lyY3VpdCA9XG4gICAgICBnYWRnZXRzOnt9XG4gICAgICB3aXJlczp7fVxuICAgICAgZmVlZHM6e31cbiAgICBqZWVidXMuYXR0YWNoICdjaXJjdWl0L2RlbW8xJ1xuICAgICAub24gJ2RhdGEnLCAoYXJncy4uLikgLT5cbiAgICAgICAgdGVtcCA9IEByb3dzXG4gICAgICAgIGZvciBvYmogaW4gdGVtcFxuICAgICAgICAgICRzY29wZS5jaXJjdWl0LmdhZGdldHNbb2JqLmlkXSA9IG9ialxuICAgICAgICBmb3Igb2JqIGluIHRlbXBcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2ggb2JqLmZlZWQsICh2LGspLT4gXG4gICAgICAgICAgICAkc2NvcGUuY2lyY3VpdC5mZWVkc1tcIiN7b2JqLmlkfS4je2t9XCJdID0gdlxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCBvYmoud2lyZSwgKHYsayktPlxuICAgICAgICAgICAgdG8gPSAodi5zcGxpdCBcIi5cIilbMF1cbiAgICAgICAgICAgIGlmICRzY29wZS5jaXJjdWl0LmdhZGdldHNbdG9dP1xuICAgICAgICAgICAgICAjIFRPRE86cmVtb3ZlIHdpcmUgZnJvbSBkYlxuICAgICAgICAgICAgICAkc2NvcGUuY2lyY3VpdC53aXJlc1tcIiN7b2JqLmlkfS4je2t9LyN7dn1cIl0gPSAwXG5cbiAgJHNjb3BlLiR3YXRjaCAnYWRkUGluJywgKHBpbikgLT5cbiAgICBpZiBwaW5cbiAgICAgICRzY29wZS5jaXJjdWl0LmZlZWRzW3Bpbl0gPz0gW11cbiAgICAgIGNvbnNvbGUubG9nICdhZGRGZWVkJywgcGluLCAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dLmxlbmd0aFxuICAgICAgJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXS5wdXNoICcnXG4gICAgICAkc2NvcGUuYWRkUGluID0gbnVsbFxuXG4gICRzY29wZS5kZWxGZWVkID0gKHBpbiwgaW5kZXgpIC0+XG4gICAgaXRlbXMgPSAkc2NvcGUuY2lyY3VpdC5mZWVkc1twaW5dXG4gICAgY29uc29sZS5sb2cgJ2RlbEZlZWQnLCBwaW4sIGluZGV4LCBpdGVtc1tpbmRleF1cbiAgICBpdGVtcy5zcGxpY2UgaW5kZXgsIDFcbiAgICBkZWxldGUgJHNjb3BlLmNpcmN1aXQuZmVlZHNbcGluXSAgaWYgaXRlbXMubGVuZ3RoIGlzIDBcbiAgXG4gICRzY29wZS4kd2F0Y2ggJ2N1cnJTZWwuaWQnLCAoeCkgLT5cbiAgICBjb25zb2xlLmxvZyAnZml4IGlkJywgeFxuICAgIHVwZGF0ZVBpbkxpc3QoKSAjIGZvciBuZXcgYW5kIGRlbGV0ZWQgZ2FkZ2V0c1xuICAkc2NvcGUuJHdhdGNoICdjdXJyU2VsLnRpdGxlJywgKHgpIC0+XG4gICAgaWYgJHNjb3BlLmN1cnJTZWwgYW5kIHg/XG4gICAgICBpZCA9ICRzY29wZS5jdXJyU2VsLmlkXG4gICAgICBvYmogPSAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXVxuICAgICAgb2JqLnRpdGxlID0geFxuICAgICAgamVlYnVzLnB1dCBcIi9jaXJjdWl0L2RlbW8xLyN7aWR9XCIsIG9ialxuICAgICAgY29uc29sZS5sb2cgJ2ZpeCB0aXRsZScsIHhcbiAgICAgIFxuICBoYW5kbGVycyA9XG4gICAgYWRkR2FkZ2V0OiAoeCwgeSkgLT4gICAgICBcbiAgICAgIGlmICRzY29wZS5uZXd0eXBlPyBcbiAgICAgICAgIyBqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1hZycsIG9ian1cbiAgICAgICAgaWQ9IFwiZ1wiICsgU3RyaW5nIERhdGUubm93KCklMTIzNDU2N1xuICAgICAgICB0eXBlID0gJHNjb3BlLm5ld3R5cGVcbiAgICAgICAgb2JqID0ge3RpdGxlOlwiI3t0eXBlfVwiLCB0eXBlOiRzY29wZS5uZXd0eXBlLCB4OngsIHk6eX1cbiAgICAgICAgamVlYnVzLnB1dCBcIi9jaXJjdWl0L2RlbW8xLyN7aWR9XCIsIG9ialxuICAgICAgICAkc2NvcGUucmVkcmF3KCkgICAgICAgICAgXG4gICAgICAgIFxuICAgIGRlbEdhZGdldDogKGlkKSAtPlxuICAgICAgIyBqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1kZycsIG9iaiwgaWR9ICAgICAgXG4gICAgICBqZWVidXMucHV0IFwiL2NpcmN1aXQvZGVtbzEvI3tpZH1cIiAgIyBwdXQgbmlsIHZhbHVlIHRvIGRlbGV0ZSBpZFxuICAgICAgJHNjb3BlLnJlZHJhdygpICAgICAgICAgIFxuICAgICAgXG4gICAgYWRkV2lyZTogKGZyb20sIHRvKSAtPiAgIFxuICAgICAgI2plZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWF3Jywgb2JqLCBmcm9tLCB0byB9XG4gICAgICBpZCA9IChmcm9tLnNwbGl0ICcuJylbMF1cbiAgICAgIG91dHB1dCA9IChmcm9tLnNwbGl0ICcuJylbMV1cbiAgICAgIG9iaiA9ICRzY29wZS5jaXJjdWl0LmdhZGdldHNbaWRdXG4gICAgICBvYmoud2lyZSA9IG9iai53aXJlIG9yIHt9XG4gICAgICBvYmoud2lyZVtvdXRwdXRdID0gdG9cbiAgICAgIGplZWJ1cy5wdXQgXCIvY2lyY3VpdC9kZW1vMS8je2lkfVwiLCBvYmogXG4gICAgICAkc2NvcGUucmVkcmF3KClcbiAgICBkZWxXaXJlOiAoZnJvbSwgdG8pIC0+ICAgICNqZWVidXMuc2VuZCB7IGNtZDogJ2NlZC1kdycsIG9iaiwgZnJvbSwgdG8gfVxuICAgICAgaWQgPSAoZnJvbS5zcGxpdCAnLicpWzBdXG4gICAgICBwaW4gPSAoZnJvbS5zcGxpdCAnLicpWzFdXG4gICAgICBvYmogPSAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXVxuICAgICAgZGVsZXRlIG9iai53aXJlW3Bpbl1cbiAgICAgIGplZWJ1cy5wdXQgXCIvY2lyY3VpdC9kZW1vMS8je2lkfVwiLCBvYmpcbiAgICAgICRzY29wZS5yZWRyYXcoKVxuICAgIHNlbFdpcmU6IChmcm9tLCB0bykgLT4gICAgI2plZWJ1cy5zZW5kIHsgY21kOiAnY2VkLWR3Jywgb2JqLCBmcm9tLCB0byB9XG4gICAgICAkc2NvcGUuY3VyclNlbCA9e31cbiAgICAgICRzY29wZS5jdXJyU2VsLmlkID0gXCIje2Zyb219LyN7dG99XCJcbiAgICAgICRzY29wZS5jdXJyU2VsLnRpdGxlID0gbnVsbFxuICAgICAgJHNjb3BlLmN1cnJTZWwudHlwZSA9IFwid2lyZVwiICMkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXS50eXBlXG4gICAgc2VsZWN0R2FkZ2V0OiAoaWQpIC0+ICAgICAjamVlYnVzLnNlbmQgeyBjbWQ6ICdjZWQtc2cnLCBvYmosIGlkICAgICAgIH1cbiAgICAgICRzY29wZS5jdXJyU2VsID17fVxuICAgICAgJHNjb3BlLmN1cnJTZWwuaWQgPSBpZFxuICAgICAgJHNjb3BlLmN1cnJTZWwudGl0bGUgPSAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXS50aXRsZVxuICAgICAgJHNjb3BlLmN1cnJTZWwudHlwZSA9ICRzY29wZS5jaXJjdWl0LmdhZGdldHNbaWRdLnR5cGVcbiAgICAgIFxuICAgIG1vdmVHYWRnZXQ6IChpZCwgeCwgeSkgLT4gI2plZWJ1cy5zZW5kIHsgY21kOiAnY2VkLW1nJywgb2JqLCBpZCwgeCwgeSB9XG4gICAgICBvYmogPSAkc2NvcGUuY2lyY3VpdC5nYWRnZXRzW2lkXVxuICAgICAgb2JqLnggPSB4XG4gICAgICBvYmoueSA9IHlcbiAgICAgIGplZWJ1cy5wdXQgXCIvY2lyY3VpdC9kZW1vMS8je2lkfVwiLCBvYmpcbiAgICAgICRzY29wZS5yZWRyYXcoKSAgICAgICAgICBcbiAgICAgIFxuXG5cbiAgJHNjb3BlLiRvbiAnY2lyY3VpdCcsIChldmVudCwgdHlwZSwgYXJncy4uLikgLT5cbiAgICBjb25zb2xlLmxvZyAnQzonLCB0eXBlLCBhcmdzLi4uXG4gICAgaGFuZGxlcnNbdHlwZV0gYXJncy4uLlxuICAgIFxuICBcbiAgICBcbiAgc2V0dXAgPSAtPlxuICAgIGplZWJ1cy5hdHRhY2ggJ2NpcmN1aXQvZGVtbzEnXG4gICAgIC5vbiAnc3luYycsIChhcmdzLi4uKSAtPlxuICAgICAgICB0ZW1wID0gQHJvd3NcbiAgICAgICAgZm9yIG9iaiBpbiB0ZW1wXG4gICAgICAgICAgJHNjb3BlLmNpcmN1aXRzW29iai5pZF0gPSBvYmpcbiAgICAgICAgY29uc29sZS5sb2cgXCJpbml0IGNpcmN1aXRzXCJcbiAgICAgIyAub24gJ2RhdGEnLCAoYXJncy4uLikgLT5cbiAgICAgIyAgICBjb25zb2xlLmxvZyAxMTEsIGFyZ3NcbiAgICAgJHNjb3BlLnJlZHJhdygpXG4gICAgXG4gICAgICAgICMxLiBUT0RPOiBjaGVjayBmb3IgdmFsdWUsIGVsc2UgcmVtb3ZlXG4gICAgICAgICMyLiBhZGQgdG8gY2lyY3VpdHNcbiAgICAgICAgIyAkc2NvcGUuY2lyY3VpdHMgcHVzaCBrLCB2XG4gICAgICAgICMzLiB0ZWxsIGVkaXRvclxuICAgICMgamVlYnVzLmF0dGFjaCAnZGVtbydcbiAgICAjICAub24gJ2RhdGEnLCAoYXJncy4uLikgLT5cbiAgICAjICAgICBjb25zb2xlLmxvZyAnZGF0YS10aW0nLCBhcmdzXG4gICAgICBcblxuICBzZXR1cCgpICBpZiAkc2NvcGUuc2VydmVyU3RhdHVzIGlzICdjb25uZWN0ZWQnXG4gICRzY29wZS4kb24gJ3dzLW9wZW4nLCBzZXR1cFxuIl19
