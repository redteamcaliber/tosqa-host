(function() {
  var ng,
    __slice = [].slice;

  ng = angular.module('myApp');

  ng.directive('jbCircuitEditor', function() {
    return {
      restrict: 'E',
      scope: {
        defs: '=',
        data: '='
      },
      link: function(scope, elem, attr) {
        var currentWire, diag, dragInfo, dragWire, emit, findPin, gadgetDrag, gadgets, glist, pinDrag, pinUnderCursor, prepareData, redraw, svg, wireUnderCursor, wires, wlist;
        svg = d3.select(elem[0]).append('svg').attr({
          width: '100%',
          height: '400px'
        });
        diag = d3.svg.diagonal().projection(function(d) {
          return [d.x, d.y];
        });
        glist = wlist = gadgets = wires = null;
        emit = function() {
          var args;
          args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
          return scope.$apply(function() {
            var _ref;
            return scope.$emit.apply(scope, [(_ref = attr.event) != null ? _ref : 'circuit'].concat(__slice.call(args)));
          });
        };
        gadgetDrag = d3.behavior.drag().origin(Object).on('dragstart', function(d) {
          d3.event.sourceEvent.stopPropagation();
          return this.parentNode.appendChild(this);
        }).on('drag', function(d) {
          d.x = d3.event.x | 0;
          d.y = d3.event.y | 0;
          d3.select(this).attr({
            transform: function(d) {
              return "translate(" + d.x + "," + d.y + ")";
            }
          });
          return wires.filter(function(w) {
            return w.source.id === d.id || w.target.id === d.id;
          }).each(function(d) {
            d.source = findPin(d.from);
            return d.target = findPin(d.to);
          }).attr({
            d: diag
          });
        }).on('dragend', function(d) {
          var g;
          g = scope.data.gadgets[d.id];
          if (!(g.x === d.x && g.y === d.y)) {
            return emit('moveGadget', d.id, d.x, d.y);
          }
        });
        dragInfo = {};
        dragWire = svg.append('path').datum(dragInfo).attr({
          id: 'drag'
        });
        wireUnderCursor = null;
        pinUnderCursor = null;
        currentWire = null;
        pinDrag = d3.behavior.drag().origin(Object).on('dragstart', function(d) {
          d3.event.sourceEvent.stopPropagation();
          dragInfo.from = d.pin;
          delete dragInfo.to;
          return dragInfo.source = findPin(d.pin);
        }).on('drag', function(d) {
          var mx, my, orig, _ref;
          _ref = d3.mouse(this), mx = _ref[0], my = _ref[1];
          orig = dragInfo.source;
          dragInfo.target = {
            x: orig.x + mx - d.x,
            y: orig.y + my - d.y
          };
          return dragWire.attr({
            "class": 'drawing',
            fill: 'none',
            d: diag
          });
        }).on('dragend', function(d) {
          dragWire.classed('drawing', false);
          if (dragInfo.to && dragInfo.to !== dragInfo.from) {
            return emit('addWire', dragInfo.from, dragInfo.to);
          }
        });
        redraw = function() {
          var g, p, pins;
          prepareData();
          gadgets = svg.selectAll('.gadget').data(glist, function(d) {
            return d.id;
          });
          wires = svg.selectAll('.wire').data(wlist, function(d) {
            return d.id;
          });
          g = gadgets.enter().append('g').call(gadgetDrag).attr({
            "class": 'gadget'
          });
          g.append('rect').each(function(d) {
            return d3.select(this).attr({
              "class": 'gadget-container',
              x: 0,
              y: 0,
              width: 140,
              height: 40,
              rx: 5,
              ry: 5
            });
          }).on('mousedown', function(d) {
            d3.selectAll('.gadget-container').classed('selected', false);
            d3.selectAll('.wire').classed('selected', false);
            d3.select(this).classed('selected', true);
            return emit('selectGadget', d.id);
          }).style({
            fill: function(d) {
              return d.def.shade;
            }
          });
          g.append('text').text(function(d) {
            return d.type;
          }).attr({
            "class": 'title',
            x: 10,
            y: 24
          });
          g.append('text').text(function(d) {
            return "" + d.id;
          }).attr({
            "class": 'label',
            x: 140,
            y: -8
          });
          g.append('text').text(function(d) {
            return '\uf014';
          }).attr({
            "class": 'delete iconfont',
            x: 130,
            y: 10
          }).style({
            'font-size': '12px'
          }).on('mouseup', function(d) {
            d3.event.stopPropagation();
            return emit('delGadget', d.id);
          });
          gadgets.exit().remove();
          pins = gadgets.selectAll('.pin').data(function(d) {
            return d.pins;
          });
          p = pins.enter().append('g').classed('pins', true);
          p.append('circle').attr({
            "class": 'pin',
            cx: (function(d) {
              return d.x + 0.5;
            }),
            cy: (function(d) {
              return d.y + .5;
            }),
            r: 3
          });
          p.append('circle').call(pinDrag).attr({
            "class": 'hit',
            cx: (function(d) {
              return d.x + 0.5;
            }),
            cy: (function(d) {
              return d.y + .5;
            }),
            r: 9
          }).on('mouseup', function(d) {
            return dragInfo.to = d.pin;
          }).on('mouseover', function(d) {
            return d3.select(this.parentNode).classed('hover', true);
          }).on('mouseout', function(d) {
            return d3.select(this.parentNode).classed('hover', false);
          });
          p.append('text').text(function(d) {
            return d.name;
          }).attr({
            "class": function(d) {
              return d.dir;
            },
            x: function(d) {
              if (d.dir === 'in') {
                return d.x - 4;
              } else {
                return d.x + 16;
              }
            },
            y: function(d) {
              if (d.dir === 'in') {
                return d.y - 10;
              } else {
                return d.y + 20;
              }
            }
          });
          pins.exit().remove();
          wires.enter().insert('path', 'g').attr({
            "class": 'wire',
            fill: 'none',
            d: diag
          }).on('mouseenter', function(d) {
            wireUnderCursor = d;
            currentWire = this;
            return d3.select(this).classed('hover', true);
          }).on('mouseleave', function(d) {
            wireUnderCursor = null;
            return d3.select(this).classed('hover', false);
          }).on('mouseDown', function() {
            d3.selectAll('.gadget-container').classed('selected', false);
            return d3.select(this).classed('selected', true);
          });
          wires.exit().remove();
          return gadgets.attr({
            transform: function(d) {
              return "translate(" + d.x + "," + d.y + ")";
            }
          });
        };
        svg.on('mousedown', function() {
          if (wireUnderCursor != null) {
            d3.selectAll('.gadget-container').classed('selected', false);
            d3.selectAll('.wire').classed('selected', false);
            d3.select(currentWire).classed('selected', true);
            return emit('selWire', wireUnderCursor.from, wireUnderCursor.to);
          } else {
            d3.selectAll('.gadget-container').classed('selected', false);
            return d3.selectAll('.wire').classed('selected', false);
          }
        });
        svg.on('dblclick', function() {
          var x, y, _ref;
          if (wireUnderCursor != null) {
            return emit('delWire', wireUnderCursor.from, wireUnderCursor.to);
          } else {
            _ref = d3.mouse(this), x = _ref[0], y = _ref[1];
            return emit('addGadget', x | 0, y | 0);
          }
        });
        findPin = function(pin) {
          var g, gid, p, pname, _i, _j, _len, _len1, _ref, _ref1;
          _ref = pin.split('.'), gid = _ref[0], pname = _ref[1];
          for (_i = 0, _len = glist.length; _i < _len; _i++) {
            g = glist[_i];
            if (gid === g.id) {
              _ref1 = g.pins;
              for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
                p = _ref1[_j];
                if (pname === p.name) {
                  return {
                    y: g.y + p.y + .5,
                    x: g.x + p.x + .5,
                    id: gid
                  };
                }
              }
            }
          }
        };
        prepareData = function() {
          var cap, def, from, g, height, hh, hw, id, ins, outs, pins, placePins, source, target, title, to, type, width, x, xstep, y;
          xstep = 20;
          width = 140;
          height = 40;
          glist = (function() {
            var _ref, _results;
            _ref = scope.data.gadgets;
            _results = [];
            for (id in _ref) {
              g = _ref[id];
              x = g.x, y = g.y, title = g.title, type = g.type;
              def = scope.defs[type];
              pins = [];
              placePins = function(pnames, dir, yi) {
                var name, nlist, xi, _i, _len;
                nlist = pnames ? pnames.split(' ') : [];
                xi = 10;
                for (_i = 0, _len = nlist.length; _i < _len; _i++) {
                  name = nlist[_i];
                  pins.push({
                    x: xi,
                    y: yi,
                    name: name,
                    dir: dir,
                    pin: "" + id + "." + name
                  });
                  xi += xstep;
                }
                return nlist.length;
              };
              hw = width / 2;
              hh = height / 2;
              ins = placePins(def.inputs, 'in', 0);
              outs = placePins(def.outputs, 'out', height);
              _results.push({
                id: id,
                x: x,
                y: y,
                title: title,
                type: type,
                def: def,
                pins: pins,
                hw: hw,
                width: width,
                hh: hh,
                height: height
              });
            }
            return _results;
          })();
          return wlist = (function() {
            var _ref, _ref1, _results;
            _ref = scope.data.wires;
            _results = [];
            for (id in _ref) {
              cap = _ref[id];
              _ref1 = id.split('/'), from = _ref1[0], to = _ref1[1];
              source = findPin(from);
              target = findPin(to);
              _results.push({
                id: id,
                from: from,
                to: to,
                source: source,
                target: target,
                cap: cap
              });
            }
            return _results;
          })();
        };
        scope.$watch("data", (function() {
          return redraw();
        }), true);
        return redraw();
      }
    };
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2lyY2VkaXQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQSxFQUFBO0lBQUEsa0JBQUE7O0FBQUEsRUFBQSxFQUFBLEdBQUssT0FBTyxDQUFDLE1BQVIsQ0FBZSxPQUFmLENBQUwsQ0FBQTs7QUFBQSxFQUVBLEVBQUUsQ0FBQyxTQUFILENBQWEsaUJBQWIsRUFBZ0MsU0FBQSxHQUFBO1dBQzlCO0FBQUEsTUFBQSxRQUFBLEVBQVUsR0FBVjtBQUFBLE1BRUEsS0FBQSxFQUNFO0FBQUEsUUFBQSxJQUFBLEVBQU0sR0FBTjtBQUFBLFFBQ0EsSUFBQSxFQUFNLEdBRE47T0FIRjtBQUFBLE1BTUEsSUFBQSxFQUFNLFNBQUMsS0FBRCxFQUFRLElBQVIsRUFBYyxJQUFkLEdBQUE7QUFDSixZQUFBLGtLQUFBO0FBQUEsUUFBQSxHQUFBLEdBQU0sRUFBRSxDQUFDLE1BQUgsQ0FBVSxJQUFLLENBQUEsQ0FBQSxDQUFmLENBQWtCLENBQUMsTUFBbkIsQ0FBMEIsS0FBMUIsQ0FDSixDQUFDLElBREcsQ0FDRTtBQUFBLFVBQUEsS0FBQSxFQUFPLE1BQVA7QUFBQSxVQUFlLE1BQUEsRUFBUSxPQUF2QjtTQURGLENBQU4sQ0FBQTtBQUFBLFFBRUEsSUFBQSxHQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUMsUUFBUCxDQUFBLENBQ0wsQ0FBQyxVQURJLENBQ08sU0FBQyxDQUFELEdBQUE7aUJBQU8sQ0FBQyxDQUFDLENBQUMsQ0FBSCxFQUFNLENBQUMsQ0FBQyxDQUFSLEVBQVA7UUFBQSxDQURQLENBRlAsQ0FBQTtBQUFBLFFBS0EsS0FBQSxHQUFRLEtBQUEsR0FBUSxPQUFBLEdBQVUsS0FBQSxHQUFRLElBTGxDLENBQUE7QUFBQSxRQU9BLElBQUEsR0FBTyxTQUFBLEdBQUE7QUFFTCxjQUFBLElBQUE7QUFBQSxVQUZNLDhEQUVOLENBQUE7aUJBQUEsS0FBSyxDQUFDLE1BQU4sQ0FBYSxTQUFBLEdB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TUFBQSxHQUFTLE9BQUEsQ0FBUSxJQUFSLENBRFQsQ0FBQTtBQUFBLGNBRUEsTUFBQSxHQUFTLE9BQUEsQ0FBUSxFQUFSLENBRlQsQ0FBQTtBQUFBLDRCQUdBO0FBQUEsZ0JBQUUsSUFBQSxFQUFGO0FBQUEsZ0JBQU0sTUFBQSxJQUFOO0FBQUEsZ0JBQVksSUFBQSxFQUFaO0FBQUEsZ0JBQWdCLFFBQUEsTUFBaEI7QUFBQSxnQkFBd0IsUUFBQSxNQUF4QjtBQUFBLGdCQUFnQyxLQUFBLEdBQWhDO2dCQUhBLENBRE07QUFBQTs7ZUEzQkk7UUFBQSxDQTdKZCxDQUFBO0FBQUEsUUE4TEEsS0FBSyxDQUFDLE1BQU4sQ0FBYSxNQUFiLEVBQXFCLENBQUMsU0FBQSxHQUFBO2lCQUNwQixNQUFBLENBQUEsRUFEb0I7UUFBQSxDQUFELENBQXJCLEVBRUcsSUFGSCxDQTlMQSxDQUFBO2VBa01BLE1BQUEsQ0FBQSxFQW5NSTtNQUFBLENBTk47TUFEOEI7RUFBQSxDQUFoQyxDQUZBLENBQUE7QUFBQSIsInNvdXJjZXNDb250ZW50IjpbIm5nID0gYW5ndWxhci5tb2R1bGUgJ215QXBwJ1xuXG5uZy5kaXJlY3RpdmUgJ2piQ2lyY3VpdEVkaXRvcicsIC0+XG4gIHJlc3RyaWN0OiAnRSdcbiAgXG4gIHNjb3BlOlxuICAgIGRlZnM6ICc9J1xuICAgIGRhdGE6ICc9J1xuICAgIFxuICBsaW5rOiAoc2NvcGUsIGVsZW0sIGF0dHIpIC0+XG4gICAgc3ZnID0gZDMuc2VsZWN0KGVsZW1bMF0pLmFwcGVuZCAnc3ZnJ1xuICAgICAgLmF0dHIgd2lkdGg6ICcxMDAlJywgaGVpZ2h0OiAnNDAwcHgnXG4gICAgZGlhZyA9IGQzLnN2Zy5kaWFnb25hbCgpXG4gICAgICAucHJvamVjdGlvbiAoZCkgLT4gW2QueCwgZC55XVxuICAgIFxuICAgIGdsaXN0ID0gd2xpc3QgPSBnYWRnZXRzID0gd2lyZXMgPSBudWxsXG4gICAgXG4gICAgZW1pdCA9IChhcmdzLi4uKSAtPlxuICAgICAgIyBmb3JjZSBhIGRpZ2VzdCwgc2luY2UgZDMgZXZlbnRzIGhhcHBlbiBvdXRzaWRlIG9mIG5nJ3MgZXZlbnQgY29udGV4dFxuICAgICAgc2NvcGUuJGFwcGx5IC0+IHNjb3BlLiRlbWl0IGF0dHIuZXZlbnQgPyAnY2lyY3VpdCcsIGFyZ3MuLi5cbiAgICAgIFxuICAgIGdhZGdldERyYWcgPSBkMy5iZWhhdmlvci5kcmFnKClcbiAgICAgIC5vcmlnaW4gT2JqZWN0XG4gICAgICAub24gJ2RyYWdzdGFydCcsIChkKSAtPlxuICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICBAcGFyZW50Tm9kZS5hcHBlbmRDaGlsZCBAICMgbW92ZSB0byBmcm9udFxuICAgICAgLm9uICdkcmFnJywgKGQpIC0+XG4gICAgICAgIGQueCA9IGQzLmV2ZW50LnggfCAwICMgc3RheSBvbiBpbnQgY29vcmRpbmF0ZXNcbiAgICAgICAgZC55ID0gZDMuZXZlbnQueSB8IDAgIyBzdGF5IG9uIGludCBjb29yZGluYXRlc1xuICAgICAgICBkMy5zZWxlY3QoQCkuYXR0ciB0cmFuc2Zvcm06IChkKSAtPiBcInRyYW5zbGF0ZSgje2QueH0sI3tkLnl9KVwiXG4gICAgICAgICAgIyByZWNhbGN1bGF0ZSBlbmRwb2ludHMgYW5kIG1vdmUgYWxsIHdpcmVzIGF0dGFjaGVkIHRvIHRoaXMgZ2FkZ2V0XG4gICAgICAgIHdpcmVzLmZpbHRlciAodykgLT4gdy5zb3VyY2UuaWQgaXMgZC5pZCBvciB3LnRhcmdldC5pZCBpcyBkLmlkXG4gICAgICAgICAgLmVhY2ggKGQpIC0+XG4gICAgICAgICAgICBkLnNvdXJjZSA9IGZpbmRQaW4gZC5mcm9tXG4gICAgICAgICAgICBkLnRhcmdldCA9IGZpbmRQaW4gZC50b1xuICAgICAgICAgIC5hdHRyIGQ6IGRpYWdcbiAgICAgIC5vbiAnZHJhZ2VuZCcsIChkKSAtPlxuICAgICAgICBnID0gc2NvcGUuZGF0YS5nYWRnZXRzW2QuaWRdXG4gICAgICAgIHVubGVzcyBnLnggaXMgZC54IGFuZCBnLnkgaXMgZC55XG4gICAgICAgICAgZW1pdCAnbW92ZUdhZGdldCcsIGQuaWQsIGQueCwgZC55XG5cbiAgICBkcmFnSW5mbyA9IHt9XG4gICAgZHJhZ1dpcmUgPSBzdmcuYXBwZW5kKCdwYXRoJykuZGF0dW0oZHJhZ0luZm8pLmF0dHIgaWQ6ICdkcmFnJ1xuICAgIHdpcmVVbmRlckN1cnNvciA9IG51bGxcbiAgICBwaW5VbmRlckN1cnNvciA9IG51bGxcbiAgICBjdXJyZW50V2lyZSA9IG51bGxcblxuICAgIHBpbkRyYWcgPSBkMy5iZWhhdmlvci5kcmFnKClcbiAgICAgIC5vcmlnaW4gT2JqZWN0XG4gICAgICAub24gJ2RyYWdzdGFydCcsIChkKSAtPlxuICAgICAgICBkMy5ldmVudC5zb3VyY2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICBkcmFnSW5mby5mcm9tID0gZC5waW5cbiAgICAgICAgZGVsZXRlIGRyYWdJbmZvLnRvXG4gICAgICAgIGRyYWdJbmZvLnNvdXJjZSA9IGZpbmRQaW4gZC5waW5cbiAgICAgIC5vbiAnZHJhZycsIChkKSAtPlxuICAgICAgICBbbXgsbXldID0gZDMubW91c2UoQClcbiAgICAgICAgb3JpZyA9IGRyYWdJbmZvLnNvdXJjZVxuICAgICAgICBkcmFnSW5mby50YXJnZXQgPSB4OiBvcmlnLngrbXgtZC54LCB5OiBvcmlnLnkrbXktZC55XG4gICAgICAgIGRyYWdXaXJlLmF0dHIgY2xhc3M6ICdkcmF3aW5nJywgZmlsbDogJ25vbmUnLCBkOiBkaWFnXG4gICAgICAub24gJ2RyYWdlbmQnLCAoZCkgLT5cbiAgICAgICAgZHJhZ1dpcmUuY2xhc3NlZCAnZHJhd2luZycsIGZhbHNlXG4gICAgICAgIGlmIGRyYWdJbmZvLnRvIGFuZCBkcmFnSW5mby50byBpc250IGRyYWdJbmZvLmZyb21cbiAgICAgICAgICBlbWl0ICdhZGRXaXJlJywgZHJhZ0luZm8uZnJvbSwgZHJhZ0luZm8udG9cblxuICAgIHJlZHJhdyA9IC0+XG4gICAgICBwcmVwYXJlRGF0YSgpXG5cbiAgICAgIGdhZGdldHMgPSBzdmcuc2VsZWN0QWxsKCcuZ2FkZ2V0JykuZGF0YSBnbGlzdCwgKGQpIC0+IGQuaWRcbiAgICAgIHdpcmVzID0gc3ZnLnNlbGVjdEFsbCgnLndpcmUnKS5kYXRhIHdsaXN0LCAoZCkgLT4gZC5pZFxuXG4gICAgICBnID0gZ2FkZ2V0cy5lbnRlcigpLmFwcGVuZCgnZycpLmNhbGwoZ2FkZ2V0RHJhZylcbiAgICAgICAgLmF0dHIgY2xhc3M6ICdnYWRnZXQnXG4gICAgICBnLmFwcGVuZCgncmVjdCcpICN0aGUgZ2FkZ2V0IG91dGxpbmVcbiAgICAgICAgLmVhY2ggKGQpIC0+XG4gICAgICAgICAgZDMuc2VsZWN0KEApLmF0dHJcbiAgICAgICAgICAgIGNsYXNzOiAnZ2FkZ2V0LWNvbnRhaW5lcidcbiAgICAgICAgICAgICMgMXB4IGxpbmVzIHJlbmRlciBzaGFycGx5IHdoZW4gb24gYSAwLjVweCBvZmZzZXRcbiAgICAgICAgICAgIHg6IDAsIHk6IDBcbiAgICAgICAgICAgIHdpZHRoOiAxNDAsIGhlaWdodDogNDBcbiAgICAgICAgICAgIHJ4OiA1XG4gICAgICAgICAgICByeTogNVxuICAgICAgICAub24gJ21vdXNlZG93bicsIChkKSAtPlxuICAgICAgICAgICMgVE9ETzogcmVtb3ZlICdzZWxlY3RlZCcgY2xhc3MgaWYgZ2FkZ2V0IGlzIGFscmVhZHkgc2VsZWN0ZWRcbiAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5nYWRnZXQtY29udGFpbmVyJykuY2xhc3NlZCAnc2VsZWN0ZWQnLCBmYWxzZVxuICAgICAgICAgICMgZGVzZWxlY3Qgd2lyZVxuICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLndpcmUnKS5jbGFzc2VkICdzZWxlY3RlZCcsIGZhbHNlIFxuICAgICAgICAgIGQzLnNlbGVjdCh0aGlzKS5jbGFzc2VkICdzZWxlY3RlZCcsIHRydWVcbiAgICAgICAgICBlbWl0ICdzZWxlY3RHYWRnZXQnLCBkLmlkXG4gICAgICAgIC5zdHlsZSBmaWxsOiAoZCkgLT4gZC5kZWYuc2hhZGVcbiAgICAgIGcuYXBwZW5kKCd0ZXh0JykudGV4dCAoZCkgLT4gZC50eXBlXG4gICAgICAgIC5hdHRyIGNsYXNzOiAndGl0bGUnLCB4OiAxMCwgeTogMjRcbiAgICAgIGcuYXBwZW5kKCd0ZXh0JykudGV4dCAoZCkgLT4gXCIje2QuaWR9XCJcbiAgICAgICAgLmF0dHIgY2xhc3M6ICdsYWJlbCcsIHg6IDE0MCwgeTogLSA4XG4gICAgICAjIGcuYXBwZW5kKCd0ZXh0JykudGV4dCAoZCkgLT4gZC5kZWYuaWNvbiAjZGlzYWJsZSB0aGUgaWNvbiBmb3Igbm93XG4gICAgICAjICAgLmF0dHIgY2xhc3M6ICdpY29uZm9udCcsIHg6IDE2LCB5OiAyMFxuICAgICAgZy5hcHBlbmQoJ3RleHQnKS50ZXh0IChkKSAtPiAnXFx1ZjAxNCcgIyBmYS10cmFzaC1vXG4gICAgICAgIC5hdHRyIGNsYXNzOiAnZGVsZXRlIGljb25mb250JywgeDogMTMwLCB5OiAxMFxuICAgICAgICAuc3R5bGUgJ2ZvbnQtc2l6ZSc6ICcxMnB4J1xuICAgICAgICAub24gJ21vdXNldXAnLCAoZCkgLT5cbiAgICAgICAgICBkMy5ldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgIGVtaXQgJ2RlbEdhZGdldCcsIGQuaWRcbiAgICAgIGdhZGdldHMuZXhpdCgpLnJlbW92ZSgpXG5cblxuICAgICAgIyBBZGQgaW5wdXQgYW5kIG91dHB1dCBwaW5zXG4gICAgICBwaW5zID0gZ2FkZ2V0cy5zZWxlY3RBbGwoJy5waW4nKS5kYXRhIChkKSAtPiBkLnBpbnNcbiAgICAgIHAgPSBwaW5zLmVudGVyKCkuYXBwZW5kKCdnJykuY2xhc3NlZCgncGlucycsIHRydWUpXG4gICAgICBwLmFwcGVuZCgnY2lyY2xlJylcbiAgICAgICAgLmF0dHIgY2xhc3M6ICdwaW4nLCBjeDogKChkKSAtPiBkLngrMC41KSwgY3k6ICgoZCkgLT4gZC55Ky41KSwgcjogM1xuICAgICAgcC5hcHBlbmQoJ2NpcmNsZScpLmNhbGwocGluRHJhZylcbiAgICAgICAgLmF0dHIgY2xhc3M6ICdoaXQnLCBjeDogKChkKSAtPiBkLngrMC41KSwgY3k6ICgoZCkgLT4gZC55Ky41KSwgcjogOVxuICAgICAgICAub24gJ21vdXNldXAnLCAgKGQpIC0+IGRyYWdJbmZvLnRvID0gZC5waW5cbiAgICAgICAgLm9uICdtb3VzZW92ZXInLCAoZCkgLT4gZDMuc2VsZWN0KHRoaXMucGFyZW50Tm9kZSkuY2xhc3NlZCgnaG92ZXInLHRydWUpXG4gICAgICAgIC5vbiAnbW91c2VvdXQnLCAgKGQpIC0+IGQzLnNlbGVjdCh0aGlzLnBhcmVudE5vZGUpLmNsYXNzZWQoJ2hvdmVyJyxmYWxzZSlcbiAgICAgIHAuYXBwZW5kKCd0ZXh0JykudGV4dCAoZCkgLT4gZC5uYW1lXG4gICAgICAgIC5hdHRyXG4gICAgICAgICAgY2xhc3M6IChkKSAtPiBkLmRpclxuICAgICAgICAgIHg6IChkKSAtPiBpZiBkLmRpciBpcyAnaW4nIHRoZW4gZC54LTQgZWxzZSBkLngrMTZcbiAgICAgICAgICB5OiAoZCkgLT4gaWYgZC5kaXIgaXMgJ2luJyB0aGVuIGQueS0xMCBlbHNlIGQueSsyMFxuICAgICAgcGlucy5leGl0KCkucmVtb3ZlKClcblxuICAgICAgd2lyZXMuZW50ZXIoKS5pbnNlcnQoJ3BhdGgnLCAnZycpICMgdXNlcyBpbnNlcnQgdG8gbW92ZSB0byBiYWNrIHJpZ2h0IGF3YXlcbiAgICAgICAgLmF0dHIgY2xhc3M6ICd3aXJlJywgZmlsbDogJ25vbmUnLCBkOiBkaWFnXG4gICAgICAgICMgY2FuJ3QgdXNlIG1vdXNlY2xpY2ssIHNlZVxuICAgICAgICAjIGh0dHBzOi8vZ3JvdXBzLmdvb2dsZS5jb20vZC9tc2cvZDMtanMvZ0h6T2o5MVgyTkEvNjVCRWYyRHVSVjRKXG4gICAgICAgIC5vbiAnbW91c2VlbnRlcicsIChkKSAtPiBcbiAgICAgICAgICB3aXJlVW5kZXJDdXJzb3IgPSBkXG4gICAgICAgICAgY3VycmVudFdpcmUgPSB0aGlzXG4gICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNsYXNzZWQoJ2hvdmVyJyx0cnVlKVxuICAgICAgICAgICMgYWRkZWQgd2lyZSBzZWxlY3Rpb25cbiAgICAgICAgLm9uICdtb3VzZWxlYXZlJywgKGQpIC0+IFxuICAgICAgICAgIHdpcmVVbmRlckN1cnNvciA9IG51bGxcbiAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZCgnaG92ZXInLGZhbHNlKVxuICAgICAgICAub24gJ21vdXNlRG93bicsIC0+XG4gICAgICAgICAgZDMuc2VsZWN0QWxsKCcuZ2FkZ2V0LWNvbnRhaW5lcicpLmNsYXNzZWQgJ3NlbGVjdGVkJywgZmFsc2VcbiAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2xhc3NlZCAnc2VsZWN0ZWQnLHRydWVcbiAgICAgIHdpcmVzLmV4aXQoKS5yZW1vdmUoKVxuXG4gICAgICBnYWRnZXRzLmF0dHIgdHJhbnNmb3JtOiAoZCkgLT4gXCJ0cmFuc2xhdGUoI3tkLnh9LCN7ZC55fSlcIlxuICAgIFxuICAgIHN2Zy5vbiAnbW91c2Vkb3duJywgLT5cbiAgICAgICMgcmV0dXJuICBpZiBkMy5ldmVudC5kZWZhdWx0UHJldmVudGVkXG4gICAgICBpZiB3aXJlVW5kZXJDdXJzb3I/XG4gICAgICAgIGQzLnNlbGVjdEFsbCgnLmdhZGdldC1jb250YWluZXInKS5jbGFzc2VkICdzZWxlY3RlZCcsIGZhbHNlXG4gICAgICAgIGQzLnNlbGVjdEFsbCgnLndpcmUnKS5jbGFzc2VkICdzZWxlY3RlZCcsIGZhbHNlXG4gICAgICAgIGQzLnNlbGVjdChjdXJyZW50V2lyZSkuY2xhc3NlZCAnc2VsZWN0ZWQnLHRydWVcbiAgICAgICAgZW1pdCAnc2VsV2lyZScsIHdpcmVVbmRlckN1cnNvci5mcm9tLCAgd2lyZVVuZGVyQ3Vyc29yLnRvXG4gICAgICAgICMgZW1pdCAnZGVsV2lyZScsIHdpcmVVbmRlckN1cnNvci5mcm9tLCB3aXJlVW5kZXJDdXJzb3IudG9cbiAgICAgICAgIyB3aXJlVW5kZXJDdXJzb3IgPSBudWxsXG4gICAgICBlbHNlICMgdW5zZWxlY3QgYWxsIHNlbGVjdGVkIGdhZGdldHNcbiAgICAgICAgZDMuc2VsZWN0QWxsKCcuZ2FkZ2V0LWNvbnRhaW5lcicpLmNsYXNzZWQoJ3NlbGVjdGVkJywgZmFsc2UpXG4gICAgICAgIGQzLnNlbGVjdEFsbCgnLndpcmUnKS5jbGFzc2VkICdzZWxlY3RlZCcsIGZhbHNlXG4gICAgc3ZnLm9uICdkYmxjbGljaycsIC0+XG4gICAgICBpZiB3aXJlVW5kZXJDdXJzb3I/XG4gICAgICAgIGVtaXQgJ2RlbFdpcmUnLCB3aXJlVW5kZXJDdXJzb3IuZnJvbSwgd2lyZVVuZGVyQ3Vyc29yLnRvXG4gICAgICBlbHNlXG4gICAgICAgIFt4LHldID0gZDMubW91c2UoQClcbiAgICAgICAgZW1pdCAnYWRkR2FkZ2V0JywgeHwwLCB5fDAgIyBjb252ZXJ0IHRvIGludHNcbiAgICAgIFxuXG4gICAgZmluZFBpbiA9IChwaW4pIC0+XG4gICAgICBbZ2lkLHBuYW1lXSA9IHBpbi5zcGxpdCAnLidcbiAgICAgIGZvciBnIGluIGdsaXN0IHdoZW4gZ2lkIGlzIGcuaWRcbiAgICAgICAgZm9yIHAgaW4gZy5waW5zIHdoZW4gcG5hbWUgaXMgcC5uYW1lXG4gICAgICAgICAgIyB1c2VzIHByb2plY3Rpb24gdG8gZ2V0IGhvcml6b250YWwgc3BsaW5lc1xuICAgICAgICAgIHJldHVybiB5OiBnLnkgKyBwLnkgKyAuNSwgeDogZy54ICsgcC54ICsgLjUsIGlkOiBnaWRcblxuICAgIHByZXBhcmVEYXRhID0gLT5cbiAgICAgIHhzdGVwID0gMjAgICMgaG9yaXpvbnRhbCBzZXBhcmF0aW9uIGJldHdlZW4gcGluc1xuICAgICAgd2lkdGggPSAxNDAgIyBmaXhlZCB3aWR0aCBmb3Igbm93XG4gICAgICBoZWlnaHQgPSA0MFxuXG4gICAgICAjIHNldCB1cCBhIGxpc3Qgb2YgZ2FkZ2V0cyB3aXRoIHNpemVzIGFuZCByZWxhdGl2ZSBwaW4gY29vcmRpbmF0ZXNcbiAgICAgIGdsaXN0ID0gZm9yIGlkLCBnIG9mIHNjb3BlLmRhdGEuZ2FkZ2V0c1xuICAgICAgICB7eCx5LHRpdGxlLHR5cGV9ID0gZ1xuICAgICAgICBkZWYgPSBzY29wZS5kZWZzW3R5cGVdXG4gICAgICAgIHBpbnMgPSBbXVxuXG4gICAgICAgIHBsYWNlUGlucyA9IChwbmFtZXMsIGRpciwgeWkpIC0+XG4gICAgICAgICAgbmxpc3QgPSBpZiBwbmFtZXMgdGhlbiBwbmFtZXMuc3BsaXQgJyAnIGVsc2UgW11cbiAgICAgICAgICB4aSA9IDEwICMgeHN0ZXAgKiAobmxpc3QubGVuZ3RoLTEpICM+PiAxICMgd2h5IHRoaXMgYml0c2hpZnQ/XG4gICAgICAgICAgZm9yIG5hbWUgaW4gbmxpc3RcbiAgICAgICAgICAgIHBpbnMucHVzaCB7IHg6IHhpLCB5OiB5aSwgbmFtZSwgZGlyLCBwaW46IFwiI3tpZH0uI3tuYW1lfVwiIH1cbiAgICAgICAgICAgIHhpICs9IHhzdGVwXG4gICAgICAgICAgbmxpc3QubGVuZ3RoXG5cbiAgICAgICAgaHcgPSB3aWR0aCAvIDJcbiAgICAgICAgaGggPSBoZWlnaHQgLyAyXG4gICAgICAgIGlucyA9IHBsYWNlUGlucyBkZWYuaW5wdXRzLCAnaW4nLCAwXG4gICAgICAgIG91dHMgPSBwbGFjZVBpbnMgZGVmLm91dHB1dHMsICdvdXQnLCBoZWlnaHRcblxuICAgICAgICB7IGlkLCB4LCB5LCB0aXRsZSwgdHlwZSwgZGVmLCBwaW5zLCBodywgd2lkdGgsIGhoLCBoZWlnaHQgfVxuXG4gICAgICAjIGNvbnZlcnQgb2JqZWN0IHRvIGxpc3QgYW5kIGxvb2t1cCB0aGUgd2lyZSBlbmRwb2ludHMgaW4gdGhlIGdhZGdldHNcbiAgICAgIHdsaXN0ID0gZm9yIGlkLCBjYXAgb2Ygc2NvcGUuZGF0YS53aXJlc1xuICAgICAgICBbZnJvbSx0b10gPSBpZC5zcGxpdCAnLydcbiAgICAgICAgc291cmNlID0gZmluZFBpbiBmcm9tXG4gICAgICAgIHRhcmdldCA9IGZpbmRQaW4gdG9cbiAgICAgICAgeyBpZCwgZnJvbSwgdG8sIHNvdXJjZSwgdGFyZ2V0LCBjYXAgfVxuICAgIFxuICAgIHNjb3BlLiR3YXRjaCBcImRhdGFcIiwgKC0+XG4gICAgICByZWRyYXcoKVxuICAgICksIHRydWVcbiAgICBcbiAgICByZWRyYXcoKVxuIl19
